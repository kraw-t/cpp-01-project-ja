# cpp-01-project-ja

## セットアップと実行の手順

`src` ディレクトリにて、以下のコマンドを実施してビルド、生成された実行ファイルを実行してください。
```
g++ -std=c++17 main.cpp map.cpp -o main
./main
```

## ゲームの説明

### ゲームの目標

あなたは自動車のドライバーです。地図を片手にできるだけ少ない手数ですべてのランドマークをまわりましょう。燃料には限りがあるので、使い切らないよう注意してください。

### ゲームの進め方

地図上に現在位置と向き、ランドマークが表示されます。
また、現在の速度、燃料残量、現在の手数、近くのランドマークの詳細も表示されるので、これらを手掛かりにコマンド入力によって自車を動かし、目標を達成してください。

### コマンドについて
以下のコマンドが使用可能です。大文字小文字は区別されるので注意してください。

|行動|基本コマンド|短縮コマンド|説明|
|:---:|:---:|:---:|:---|
|左折|turn left|l|交差点に居るときに使用可能、左に進路を変え、現在の速度分直進します|
|右折|turn right|r|交差点に居るときに使用可能、右に進路を変え、現在の速度分直進します|
|直進|continue straight|c|現在の進行方向のまま、速度分進みます|
|加速|accelerate|a|速度を一段階上げ(最大3)、直進します。また停止状態から発進します|
|減速|decelerate|d|速度を一段階下げ(最低1)、直進します|
|停止|stop|s|直ちに停止します|
|ゲーム終了|game end||ゲームを終了します|

それ以外のコマンドが入力された場合は、再度コマンド入力が促されます。

### ゲームの終了について

以下の場合にゲーム終了となります

#### 目標達成

燃料を使い切ることなく、すべてのランドマークに到達した際に目標達成となりゲーム終了します。
最終的な手数が表示されるので、より少ない数を目指しましょう。
ランドマークは通過ではなくちょうどそのマスに乗ることで「到着」と判定されます。

#### ゲームオーバー

以下の場合にゲームオーバーとなります。再挑戦をお待ちしています。

* 途中で燃料を使い切ったとき
  * 燃料消費量は速度を上げると増えるので、速度調整に気を使ってみましょう
* 道路外に出てしまったとき
  * 速度を上げると1手で複数マス進めるようになりますが、進んだ先が道路外であった場合にはスピードオーバーで路外逸脱となりゲームオーバーになります。曲がり角では速度をうまく調節しましょう。

#### ユーザーによる終了

game end コマンドを使用することでいつでもゲームを終了できます。

## ゲームのカスタマイズ

以下のconst変数や関数内の処理を変更することで、ゲームをカスタマイズできます。
ゲームが進行できないような無効な設定になっている場合は事前の検証によりエラーが発生します。

### 地図の変更

`map.cpp` の `const std::array<std::array<unsigned int, map_size_x>, map_size_y> map` 及びサイズを変更することで地図を変更できます。
この配列変数は0(道路外),1(道路)のみを記述してください。
また、袋小路を作らないようにしてください。
これらを誤るとエラーになります。

初期の自車位置は `map.hpp` の以下の変数で変更できます。
```
constexpr unsigned int initial_x
constexpr unsigned int initial_y
constexpr Direction initial_direction
``````
道路外や、道路上でも道路外を向いた状態で配置するとエラーになります。

### ランドマークの変欧

`main.cpp` の `setLandmerks()` にてランドマークを作ってpush_backしているので、それらを変更・追加することで好きな位置にランドマークを配置できます。ランドマークが道路外に設定されているとエラーとなります。

### 速度、燃料系の設定

それぞれ `main.cpp` の以下の定数を変更することでカスタマイズできます

* 最大速度：`unsigned int max_speed`
* 最低速度：`unsigned int min_speed`
* 初期の燃料：`int fuel_init`
* 燃料消費量：`std::array<int, ※> fuel_consumption {1, 1, 3, 9};`  
※ 速度に応じた燃料消費量であるため、最大速度の数だけ要素数が必要です

## プロジェクトにおける重要な設計やその設計理由

#### ゲーム進行が不可能になる事象を引き起こさないための検証機能を追加した。

地図の作り方、ランドマークの配置の仕方、初期位置の置き方によって、ゲーム進行が不可能になる可能性があったため。

#### 地図変数やその要素数変数、速度や位置など、絶対に値をとらない設定のものは必ず `unsigned` で定義した。

これにより負の数が入る可能性が無いので、配列外アクセスガードなどの記述がシンプルにできた。

#### 選択肢が限られるもの（方角、コマンド）は `enum` を利用した。

これにより、意図する範囲外の数値が入ることを防止し、コードをシンプルにできた。

